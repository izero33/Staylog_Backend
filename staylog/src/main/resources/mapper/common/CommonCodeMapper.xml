<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.staylog.staylog.domain.common.mapper.CommonCodeMapper">

    <resultMap id="CommonCodeMap" type="com.staylog.staylog.domain.common.dto.CommonCodeDto">
        <result property="codeId" column="CODE_ID"/>
        <result property="parentId" column="PARENT_ID"/>
        <result property="codeName" column="CODE_NAME"/>
        <result property="codeNameEn" column="CODE_NAME_EN"/>
        <result property="description" column="DESCRIPTION"/>
        <result property="depth" column="DEPTH"/>
        <result property="displayOrder" column="DISPLAY_ORDER"/>
        <result property="useYn" column="USE_YN"/>
        <result property="attr1" column="ATTR1"/>
        <result property="attr2" column="ATTR2"/>
        <result property="attr3" column="ATTR3"/>
        <result property="attr4" column="ATTR4"/>
        <result property="attr5" column="ATTR5"/>
    </resultMap>

    <!-- 부모 ID로 자식 코드 조회 -->
    <select id="getCodesByParentId" resultMap="CommonCodeMap">
        SELECT
            CODE_ID,
            PARENT_ID,
            CODE_NAME,
            CODE_NAME_EN,
            DESCRIPTION,
            DEPTH,
            DISPLAY_ORDER,
            USE_YN,
            ATTR1,
            ATTR2,
            ATTR3,
            ATTR4,
            ATTR5
        FROM COMMON_CODE
        WHERE PARENT_ID = #{parentId}
          AND USE_YN = 'Y'
        ORDER BY DISPLAY_ORDER ASC, CODE_ID ASC
    </select>

    <!-- 모든 공통코드 조회 (Depth 1만, USE_YN = 'Y') -->
    <select id="getAllCommonCodes" resultMap="CommonCodeMap">
        SELECT
            CODE_ID,
            PARENT_ID,
            CODE_NAME,
            CODE_NAME_EN,
            DESCRIPTION,
            DEPTH,
            DISPLAY_ORDER,
            USE_YN,
            ATTR1,
            ATTR2,
            ATTR3,
            ATTR4,
            ATTR5
        FROM COMMON_CODE
        WHERE DEPTH = 1
          AND USE_YN = 'Y'
        ORDER BY PARENT_ID ASC, DISPLAY_ORDER ASC, CODE_ID ASC
    </select>

</mapper>
